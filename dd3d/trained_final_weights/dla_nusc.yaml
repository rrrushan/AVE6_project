WANDB:
  ENABLED: false
  DRYRUN: false
  PROJECT: dd3d
  GROUP: null
  TAGS:
  - nusc-val
  - dla_custom
  - bn
EVAL_ONLY: false
EVAL_ON_START: false
ONLY_REGISTER_DATASETS: false
OUTPUT_ROOT: ./outputs
SYNC_OUTPUT_DIR_S3:
  ENABLED: false
  ROOT_IN_S3: ???
  PERIOD: 1000
DATASET_ROOT: /media/mobilitylabextreme002/Data1/Videos/
TMP_DIR: /tmp/
DATASETS:
  TRAIN:
    NAME: nusc_train
    CANONICAL_BOX3D_SIZES:
    - - 2.3524184
      - 0.5062202
      - 1.0413622
    - - 0.61416006
      - 1.7016163
      - 1.3054738
    - - 2.9139307
      - 10.725025
      - 3.2832346
    - - 1.9751819
      - 4.641267
      - 1.74352
    - - 2.772134
      - 6.565072
      - 3.2474296
    - - 0.7800532
      - 2.138673
      - 1.4437162
    - - 0.6667362
      - 0.7181772
      - 1.7616143
    - - 0.40246472
      - 0.4027083
      - 1.0084083
    - - 3.0059454
      - 12.8197
      - 4.1213827
    - - 2.4986045
      - 6.9310856
      - 2.8382742
    DATASET_MAPPER: nuscenes
    NUM_CLASSES: 10
    MEAN_DEPTH_PER_LEVEL:
    - 44.921
    - 20.252
    - 11.712
    - 7.166
    - 8.548
    STD_DEPTH_PER_LEVEL:
    - 24.331
    - 9.833
    - 6.223
    - 4.611
    - 8.275
    MIN_NUM_LIDAR_PTS: 3
    MIN_BOX_VISIBILITY: 0.2
  TEST:
    NAME: nusc_val-subsample-8
    NUSC_SAMPLE_AGGREGATE_IN_INFERENCE: true
    DATASET_MAPPER: default
    NUM_IMAGES_PER_SAMPLE: 6
FE:
  FPN:
    IN_FEATURES: ${..BACKBONE.OUT_FEATURES}
    OUT_FEATURES: null
    OUT_CHANNELS: 256
    NORM: FrozenBN
    FUSE_TYPE: sum
  BUILDER: build_fcos_dla_fpn_backbone_p67
  BACKBONE:
    NAME: DLA-34
    OUT_FEATURES:
    - level3
    - level4
    - level5
    NORM: FrozenBN
  OUT_FEATURES: ${.FPN.OUT_FEATURES}
DD3D:
  IN_FEATURES: ${FE.OUT_FEATURES}
  NUM_CLASSES: ${DATASETS.TRAIN.NUM_CLASSES}
  FEATURE_LOCATIONS_OFFSET: none
  SIZES_OF_INTEREST:
  - 64
  - 128
  - 256
  - 512
  INFERENCE:
    DO_NMS: true
    DO_POSTPROCESS: true
    DO_BEV_NMS: false
    BEV_NMS_IOU_THRESH: 0.3
    NUSC_SAMPLE_AGGREGATE: false
  FCOS2D:
    _VERSION: v2
    NORM: BN
    NUM_CLS_CONVS: 4
    NUM_BOX_CONVS: 4
    USE_DEFORMABLE: false
    USE_SCALE: true
    BOX2D_SCALE_INIT_FACTOR: 1.0
    LOSS:
      ALPHA: 0.25
      GAMMA: 2.0
      LOC_LOSS_TYPE: giou
    INFERENCE:
      THRESH_WITH_CTR: true
      PRE_NMS_THRESH: 0.05
      PRE_NMS_TOPK: 1000
      POST_NMS_TOPK: 100
      NMS_THRESH: 0.75
  FCOS3D:
    NORM: FrozenBN
    NUM_CONVS: 4
    USE_DEFORMABLE: false
    USE_SCALE: true
    DEPTH_SCALE_INIT_FACTOR: 0.3
    PROJ_CTR_SCALE_INIT_FACTOR: 1.0
    PER_LEVEL_PREDICTORS: false
    SCALE_DEPTH_BY_FOCAL_LENGTHS: true
    SCALE_DEPTH_BY_FOCAL_LENGTHS_FACTOR: 500.0
    MEAN_DEPTH_PER_LEVEL: ${DATASETS.TRAIN.MEAN_DEPTH_PER_LEVEL}
    STD_DEPTH_PER_LEVEL: ${DATASETS.TRAIN.STD_DEPTH_PER_LEVEL}
    MIN_DEPTH: 0.1
    MAX_DEPTH: 80.0
    CANONICAL_BOX3D_SIZES: ${DATASETS.TRAIN.CANONICAL_BOX3D_SIZES}
    CLASS_AGNOSTIC_BOX3D: false
    PREDICT_ALLOCENTRIC_ROT: true
    PREDICT_DISTANCE: false
    LOSS:
      SMOOTH_L1_BETA: 0.05
      MAX_LOSS_PER_GROUP_DISENT: 20.0
      CONF_3D_TEMPERATURE: 1.0
      WEIGHT_BOX3D: 2.0
      WEIGHT_CONF3D: 1.0
    PREPARE_TARGET:
      CENTER_SAMPLE: true
      POS_RADIUS: 1.5
  NUSC:
    LOSS:
      WEIGHT_ATTR: 0.2
      WEIGHT_SPEED: 0.2
    INFERENCE:
      NUM_IMAGES_PER_SAMPLE: ${DATASETS.TEST.NUM_IMAGES_PER_SAMPLE}
      MAX_NUM_DETS_PER_SAMPLE: 500
VIS:
  DATALOADER_ENABLED: true
  DATALOADER_PERIOD: 1000
  DATALOADER_MAX_NUM_SAMPLES: 10
  PREDICTIONS_ENABLED: true
  PREDICTIONS_MAX_NUM_SAMPLES: 20
  D2:
    DATALOADER:
      ENABLED: true
      SCALE: 1.0
      COLOR_MODE: image
    PREDICTIONS:
      ENABLED: true
      SCALE: 1.0
      COLOR_MODE: image
      THRESHOLD: 0.4
  BOX3D:
    DATALOADER:
      ENABLED: true
      SCALE: 1.0
      RENDER_LABELS: true
    PREDICTIONS:
      ENABLED: true
      SCALE: 1.0
      RENDER_LABELS: true
      THRESHOLD: 0.5
      MIN_DEPTH_CENTER: 0.0
INPUT:
  FORMAT: BGR
  AUG_ENABLED: true
  RESIZE:
    ENABLED: true
    MIN_SIZE_TRAIN:
    - 640
    - 672
    - 704
    - 736
    - 768
    - 800
    - 832
    - 864
    - 896
    - 928
    - 960
    - 992
    - 1024
    - 1056
    - 1088
    - 1120
    - 1152
    MIN_SIZE_TRAIN_SAMPLING: choice
    MAX_SIZE_TRAIN: 10000
    MIN_SIZE_TEST: 896
    MAX_SIZE_TEST: 100000
  CROP:
    ENABLED: false
    TYPE: relative_range
    SIZE:
    - 0.9
    - 0.9
  RANDOM_FLIP:
    ENABLED: true
    HORIZONTAL: true
    VERTICAL: false
  COLOR_JITTER:
    ENABLED: true
    BRIGHTNESS:
    - 0.2
    - 0.2
    SATURATION:
    - 0.2
    - 0.2
    CONTRAST:
    - 0.2
    - 0.2
MODEL:
  DEVICE: cuda
  META_ARCHITECTURE: NuscenesDD3D
  PIXEL_MEAN:
  - 103.53
  - 116.28
  - 123.675
  PIXEL_STD:
  - 57.375
  - 57.12
  - 58.395
  CKPT: /home/carla/admt_student/team3_ss23/AVE6_project/dd3d/trained_final_weights/dla34_nusc_step6k.pth
  BOX2D_ON: true
  BOX3D_ON: true
  DEPTH_ON: false
  RELOAD_CKPT: true
DATALOADER:
  TRAIN:
    NUM_WORKERS: 12
    FILTER_EMPTY_ANNOTATIONS: true
    SAMPLER: RepeatFactorTrainingSampler
    REPEAT_THRESHOLD: 0.4
    ASPECT_RATIO_GROUPING: false
  TEST:
    NUM_WORKERS: 4
    SAMPLER: InferenceGroupSampler
    NUM_IMAGES_PER_GROUP: ${DATASETS.TEST.NUM_IMAGES_PER_SAMPLE}
SOLVER:
  IMS_PER_BATCH: 8
  BASE_LR: 0.002
  MOMENTUM: 0.9
  NESTEROV: false
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_NORM: 0.0
  BIAS_LR_FACTOR: 1.0
  WEIGHT_DECAY_BIAS: ${.WEIGHT_DECAY}
  GAMMA: 0.1
  LR_SCHEDULER_NAME: WarmupMultiStepLR
  STEPS:
  - 100000
  - 115000
  WARMUP_FACTOR: 0.0001
  WARMUP_ITERS: 2000
  WARMUP_METHOD: linear
  CLIP_GRADIENTS:
    ENABLED: false
    CLIP_TYPE: value
    CLIP_VALUE: 1.0
    NORM_TYPE: 2.0
  CHECKPOINT_PERIOD: 2000
  MIXED_PRECISION_ENABLED: true
  DDP_FIND_UNUSED_PARAMETERS: false
  ACCUMULATE_GRAD_BATCHES: 8
  SYNCBN_USE_LOCAL_WORKERS: false
  MAX_ITER: 120000
TEST:
  ENABLED: true
  EVAL_PERIOD: 2000
  EVAL_ON_START: false
  ADDITIONAL_EVAL_STEPS: []
  IMS_PER_BATCH: 12
  AUG:
    ENABLED: true
    MIN_SIZES:
    - 640
    - 768
    - 896
    - 1024
    - 1152
    MAX_SIZE: 100000
    FLIP: true
EVALUATORS:
  NUSCENES: {}
